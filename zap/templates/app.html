<h1>âš¡Zap - {{ .Config.Host }}</h1>

<p>Status: {{ .Status }}</p>

<pre id="log">...</pre>

<script type="text/javascript">
  var status = "{{ .Status }}";

  if (status != "running") {
    setTimeout(function(){window.location.reload(1);}, 2000);
  }

  function fetch() {
    setTimeout(function(){get("/zap/log", updateLog);}, 500);
  }

  function updateLog(data) {
    document.getElementById("log").innerHTML = data;
    fetch();
  }

  function get(url, callback){
    var xmlhttp;
    xmlhttp = new XMLHttpRequest();
    xmlhttp.onreadystatechange = function(){
      if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
          callback(xmlhttp.responseText);
      }
    }
    xmlhttp.open("GET", url, true);
    xmlhttp.send();
  }

  fetch();
</script>
